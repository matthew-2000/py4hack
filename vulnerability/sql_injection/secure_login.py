import sqlite3

def secure_login(user_input, pass_input):
    conn = sqlite3.connect("demo.db")
    c = conn.cursor()

    # Query parametrizzata
    query = "SELECT * FROM utenti WHERE username=? AND password=?"
    c.execute(query, (user_input, pass_input))
    result = c.fetchone()
    conn.close()

    if result:
        print(f"[OK] Login corretto per {result[0]}")
    else:
        print("[NO] Credenziali non valide.")

# Input utente
if __name__ == '__main__':
    user = input("Username: ")
    pwd = input("Password: ")
    secure_login(user, pwd)
