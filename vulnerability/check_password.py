import requests
import hashlib

def check_pwned(password):
    sha1_hash = hashlib.sha1(password.encode()).hexdigest().upper()
    print(sha1_hash)
    prefix = sha1_hash[:5]
    suffix = sha1_hash[5:]

    url = f"https://api.pwnedpasswords.com/range/{prefix}"
    response = requests.get(url)
    
    hashes = response.text.splitlines()  # Dividi la risposta in righe
    for line in hashes:
        h_suffix, count = line.split(":")  # Separiamo l'hash dalla quantità
        if h_suffix == suffix:
            print(f"❌ La password è stata trovata in {count} violazioni!")
            return

    print("✅ La password sembra sicura.")

password = input("Inserisci la password da verificare: ")
check_pwned(password)